{% extends 'battle/base.html' %}
{% load static %}

{% block title %}Battle - Clash of Code{% endblock %}
{% block content %}

<input type="hidden" id="battleId" value="{{ battle.id }}">
<!-- Navbar -->
<nav class="navbar">
    <div class="nav-left">
        <div class="opp-status-container">
            <div class="pulse-dot"></div>
            <span class="opp-text">OPP LIVE ACTIONS</span>
        </div>
    </div>

    <div class="nav-center">
        <span class="vs-text">{{ user_a.username }} <span class="vs-accent">VS</span> {{ user_b.username }}</span>
    </div>

    <div class="nav-right">
        <span class="timer-label">TIME LEFT:</span>
        <span class="timer-value" id="timer">00:15:00</span>
    </div>
</nav>

<!-- Main Workspace -->
<div class="workspace">
    <!-- Left Pane: Problem View -->
    <div class="pane pane-left" id="leftPane">
        <div class="problem-header">
            <div class="problem-title-row">
                <h1 class="problem-title" id="problemTitle"><span id="problemId">{{ question.id }}.</span>{{ question.title }}</h1>
                <span class="badge diff-easy" id="problemDifficulty">{{ question.difficulty }}</span>
            </div>

            <div class="problem-tabs">
                <button class="tab-btn active" data-tab="desc">Description</button>
                <!-- Editorial Removed -->
                <button class="tab-btn" data-tab="submissions">Submissions</button>
            </div>
        </div>

        <div class="problem-content scroll-container">
            <!-- Problem Description Content -->
            <div id="desc" class="tab-content active">
                <div class="p-text">
                    {{ question.description|safe }}
                </div>

                <h3 class="section-title">Input Format</h3>
                <p class="p-text">{{ question.input_format|safe }}</p>

                <h3 class="section-title">Output Format</h3>
                <p class="p-text">{{ question.output_format|safe }}</p>

                {% for sample in question.samples %}
                <div class="sample-case">
                    <div class="sample-header">
                        <span>Sample {{ forloop.counter }}</span>
                    </div>
                    <div class="io-grid">
                        <div class="io-block">
                            <div class="io-title-row">
                                <span class="io-label">Input</span>
                                <span class="copy-btn" data-target="input">Copy</span>
                            </div>
                            <pre class="io-content">{{ sample.input }}</pre>
                        </div>
                        <div class="io-block">
                            <div class="io-title-row">
                                <span class="io-label">Output</span>
                                <span class="copy-btn" data-target="output">Copy</span>
                            </div>
                            <pre class="io-content">{{ sample.output }}</pre>
                        </div>
                    </div>
                </div>
                {% endfor %}

                {% if question.explanation %}
                <div class="explanation-box">
                    <h3 class="section-title">Explanation</h3>
                    <p class="p-text">{{ question.explanation|safe }}</p>
                </div>
                {% endif %}
            </div>

            <!-- Submissions Content Placeholder -->
            <div id="submissions" class="tab-content hidden">
                <div class="submission-list">
                    <p class="p-text" style="color: var(--text-secondary); text-align: center; margin-top: 20px;">No
                        submissions yet.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Resizer Handle Horizontal -->
    <div class="resizer resizer-horizontal" id="dragHandle"></div>

    <!-- Right Pane: Code Editor & Test Cases -->
    <div class="pane pane-right" id="rightPane">
        <!-- Editor Section -->
        <div class="editor-section" id="editorSection">
            <div class="editor-toolbar">
                <div class="lang-selector-container">
                    <select class="lang-select", id="languageSelect">
                        <option value="python" version="3.10.0">Python 3</option>
                        <option value="cpp" version="13.0.1">C++</option>
                        <option value="java" version="17.0.1">Java</option>
                    </select>
                </div>
                <div class="editor-actions">
                    <button class="icon-btn" title="Settings">⚙️</button>
                    <button class="icon-btn" title="Reset Code">↺</button>
                </div>
            </div>

            <!-- Editable Monaco-like Area -->
            <div class="monaco-placeholder editable-monaco">
                <div class="line-numbers" id="lineNumbers">
                    <span>1</span><span>2</span><span>3</span><span>4</span>
                </div>
                <textarea class="code-area-input" id="codeEditor" spellcheck="false">
# Write your code here
</textarea>
            </div>
        </div>

        <!-- Vertical Resize Handle -->
        <div class="resizer resizer-vertical" id="dragHandleVertical"></div>

        <!-- Bottom Section: Test Cases (CodeChef Style) -->
        <div class="bottom-section" id="bottomSection">
            <div class="testcase-panel-header">
                <div class="tc-tabs">
                    <button class="tc-tab active" data-target="tc-input">Testcase</button>
                    
                </div>
            </div>

            <div class="testcase-body">
                <!-- Custom Input View -->
                <div id="tc-input" class="tc-view active">
                    <div class="tc-split-view">
                        <div class="tc-box">
                            <label class="io-label" >Custom Input</label>
                            <textarea class="tc-textarea" id="customInput" spellcheck="false">
</textarea>
                        </div>
                        <div class="tc-box">
                            <label class="io-label" id="outputLabel">Output</label>
                            <textarea class="tc-textarea readonly" id="customOutput" readonly spellcheck="false">Run code to see results</textarea>
                        </div>
                    </div>
                </div>

            </div>

            <div class="action-bar-footer">
                <button class="btn-console">Console</button>
                <div class="run-submit-group">
                    <button class="btn-run" id="btn-run">Run</button>
                    <button class="btn-submit" id="btn-submit">Submit</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}